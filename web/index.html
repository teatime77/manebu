<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>MathJaxテスト</title>
    <script type="text/javascript" src="js/main.js" ></script>
    <script type="text/javascript" src="js/speech.js" ></script>
    <script type="text/javascript" src="js/mymathjax.js" ></script>
    <style>
        li {
          margin-top: 10px;
          margin-bottom: 10px;
        }
      </style>  

<script type="text/javascript">

function body_onload(){
    console.log("body load");
    manebu.init_manebu();
}
function loadData(){
    var this_url = window.location.href;
    var k = this_url.lastIndexOf('/');
    var data_url = this_url.substring(0, k) + "/data/data.json";

    fetch(data_url)
    .then(function(response) {
        return response.json();
    })
    .then(function(json_data) {
        console.log(JSON.stringify(json_data));

        manebu.actions = json_data;
        manebu.play(0)
    });
}

function startPlay(){
    manebu.play(0)
}

function copyData(){
    var s = JSON.stringify(manebu.actions);
    console.log(s);

    navigator.clipboard.writeText(s).then(function() {
        console.log("copy ok");
    }, 
    function() {
      console.log("copy ng");
    });    
}

function addTextBlock_resume(){
    manebu.addTextBlock(manebu.textMath.value);
    manebu.resume();
}

function addSpeech_resume(){
    manebu.addSpeech(manebu.textMath.value);
    manebu.resume();
}
</script>
  
</head>
<body onload="body_onload()" style="margin:0px; padding:0px">

<!-- $$
\newcommand{\P}{\mathcal{P}}
\\
\newcommand{\F}{\mathcal{F}}
\\
\newcommand{\L}{\mathcal{L}}
\newcommand{\U}{{}^\ast U}
$$ -->

<table>
  <tr>
    <td>
      メニュー
      <button onclick="loadData();">開く</button>  
      <button onclick="copyData();">コピー</button>  
      <button onclick="startPlay();">再生</button>  
      <button onclick="manebu.speak();">音声合成のテスト</button>  
    </td>
    <td style="width: 200px" ></td>
  </tr>

  <tr>
      <td>
        数式<br/>
        <div id="div-math" style="width: 600px"></div>      
      </td>
  </tr>

  <tr>
      <td>
        入力 &#x1f640;<br/>
        <textarea id="txt-math" cols="80" rows="8" onblur="manebu.txt_math_onblur" onselect="manebu.txt_math_onselect()" >
これは$\sqrt{2 \pi}$二乗です。
$$
\v{x_n}^2 + \v{x_n} + \v{x}^2
\\
\frac{1}{ {(2 \pi)}^{D/2}  } \frac{1}{ {\mid \Sigma \mid}^{ 1/2 }  } 
\exp \{ - \frac{1}{2}   {(\v{x_n}^2 - \v{\mu})}^T \Sigma^{-1} (\v{x_n} - \v{\mu}^2) \}
$$
        </textarea>
      </td>
      <td>
          <button onclick="addTextBlock_resume()">テキストを追加</button> <hr/>
          <button onclick="addSpeech_resume()">音声を追加</button>  
      </td>
    </tr>

  <tr>
      <td>
        メッセージ      
      </td>
  </tr>
</table>




</body></html>